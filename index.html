<!DOCTYPE html>
<html lang="ru">

  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–ò–≥–æ—Ä—å –∏ —Ç–æ—Å–∫–∞ –ø–æ 2007</title>
    <style>
      body {
        font-family: 'Comic Sans MS', cursive, sans-serif;
        background-color: #1e1e2f;
        color: #fff;
        text-align: center;
        padding: 2rem;
        transition: filter 0.4s ease;
      }

      h1 {
        color: #f06292;
        text-shadow: 0 0 5px #f06292;
      }

      .time-display {
        position: fixed;
        top: 10px;
        right: 10px;
        background: #2e2e40;
        padding: 10px 15px;
        border-radius: 8px;
        border: 1px solid #f06292;
        font-size: 14px;
      }

      .igor-container {
        border: 2px dashed #f06292;
        border-radius: 10px;
        padding: 1.5rem;
        max-width: 700px;
        margin: auto;
        background-color: #2e2e40;
        transition: all 0.3s ease;
      }

      button {
        margin: 8px;
        padding: 10px 16px;
        border: none;
        background-color: #f06292;
        color: white;
        font-size: 15px;
        border-radius: 5px;
        cursor: pointer;
        transition: 0.2s;
      }

      button:hover {
        background-color: #ec407a;
      }

      button:disabled {
        background-color: #666;
        cursor: not-allowed;
      }

      .output {
        text-align: left;
        margin-top: 20px;
        font-size: 14px;
        background: #1e1e2f;
        padding: 1rem;
        border: 1px solid #444;
        border-radius: 5px;
        white-space: pre-wrap;
        overflow-x: auto;
        max-width: 100%;
      }

      .output pre {
        margin: 0;
        white-space: pre-wrap;
        word-wrap: break-word;
        overflow-wrap: break-word;
      }

      .title {
        margin-bottom: 1rem;
        font-size: 1.2rem;
        color: #ffab91;
      }

      .astral {
        color: #b39ddb;
        font-size: 1.3rem;
        margin-top: 1rem;
      }

      .achievement-popup {
        position: fixed;
        top: 80px;
        right: 20px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        padding: 15px 20px;
        border-radius: 10px;
        border: 2px solid #fff;
        box-shadow: 0 0 20px rgba(102, 126, 234, 0.6);
        animation: slideIn 0.5s ease-out;
        z-index: 1000;
        max-width: 300px;
      }

      .event-popup {
        position: fixed;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        background: #2e2e40;
        padding: 20px;
        border-radius: 10px;
        border: 2px solid #f06292;
        box-shadow: 0 0 20px rgba(240, 98, 146, 0.6);
        animation: slideUp 0.5s ease-out;
        z-index: 999;
        max-width: 400px;
      }

      .event-buttons {
        margin-top: 15px;
        display: flex;
        gap: 10px;
        justify-content: center;
      }

      @keyframes slideIn {
        from {
          transform: translateX(400px);
          opacity: 0;
        }

        to {
          transform: translateX(0);
          opacity: 1;
        }
      }

      @keyframes slideUp {
        from {
          transform: translate(-50%, 200px);
          opacity: 0;
        }

        to {
          transform: translate(-50%, 0);
          opacity: 1;
        }
      }

      .achievements {
        margin-top: 20px;
        background: #1e1e2f;
        padding: 15px;
        border-radius: 8px;
        border: 1px solid #444;
      }

      .achievement-item {
        display: inline-block;
        margin: 5px;
        padding: 8px 12px;
        background: #2e2e40;
        border-radius: 5px;
        font-size: 12px;
        border: 1px solid #666;
      }

      .achievement-item.unlocked {
        border-color: #f06292;
        background: linear-gradient(135deg, #667eea22 0%, #764ba222 100%);
      }

      /* –≠–§–§–ï–ö–¢–´ –ê–°–¢–†–ê–õ–ê */
      .astral-mode {
        animation: shake 0.4s infinite;
        filter: hue-rotate(270deg) contrast(1.2) brightness(1.1) saturate(1.5);
      }

      .astral-text {
        animation: flicker 1s infinite alternate;
      }

      @keyframes shake {
        0% {
          transform: translate(1px, 1px) rotate(0deg);
        }

        10% {
          transform: translate(-1px, -2px) rotate(-1deg);
        }

        20% {
          transform: translate(-3px, 0) rotate(1deg);
        }

        30% {
          transform: translate(3px, 2px) rotate(0deg);
        }

        40% {
          transform: translate(1px, -1px) rotate(1deg);
        }

        50% {
          transform: translate(-1px, 2px) rotate(-1deg);
        }

        60% {
          transform: translate(-3px, 1px) rotate(0deg);
        }

        70% {
          transform: translate(3px, 1px) rotate(-1deg);
        }

        80% {
          transform: translate(-1px, -1px) rotate(1deg);
        }

        90% {
          transform: translate(1px, 2px) rotate(0deg);
        }

        100% {
          transform: translate(1px, -2px) rotate(-1deg);
        }
      }

      @keyframes flicker {
        0% {
          opacity: 1;
        }

        50% {
          opacity: 0.6;
        }

        100% {
          opacity: 1;
        }
      }

      .tabs {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
        justify-content: center;
      }

      .tab-button {
        padding: 10px 20px;
        background: #1e1e2f;
        border: 2px solid #444;
        border-radius: 8px 8px 0 0;
        cursor: pointer;
      }

      .tab-button.active {
        background: #2e2e40;
        border-bottom: 2px solid #2e2e40;
      }

      .tab-content {
        display: none;
      }

      .tab-content.active {
        display: block;
      }

    </style>
  </head>

  <body>
    <div class="time-display" id="timeDisplay">üïê 00:00</div>

    <h1>üß† –ò–≥–æ—Ä—å, —Ç–æ—Å–∫–∞ –∏ –¢–ê–¢–£</h1>

    <div class="igor-container" id="igorBox">
      <div class="tabs">
        <button class="tab-button active" onclick="switchTab('main')">–ì–ª–∞–≤–Ω–∞—è</button>
        <button class="tab-button" onclick="switchTab('achievements')">–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</button>
        <button class="tab-button" onclick="switchTab('internet')">–ò–Ω—Ç–µ—Ä–Ω–µ—Ç 2007</button>
        <button class="tab-button" onclick="switchTab('babushka')">–£ –±–∞–±—É—à–∫–∏</button>
      </div>

      <div id="main-tab" class="tab-content active">
        <div>
          <span style="display:block; margin-bottom: 5px;">–í—ã–±–µ—Ä–∏ –Ω–∞–ø–∏—Ç–æ–∫:</span>
          <button onclick="igor.drinkAlcohol('–ø–∏–≤–æ')">üç∫ –ü–∏–≤–æ</button>
          <button onclick="igor.drinkAlcohol('–≤–∏–Ω–æ')">üç∑ –í–∏–Ω–æ</button>
          <button onclick="igor.drinkAlcohol('–≤–æ–¥–∫–∞')">ü•É –í–æ–¥–∫–∞</button>
          <button onclick="igor.drinkAlcohol('—Å–∞–º–æ–≥–æ–Ω')">üî• –°–∞–º–æ–≥–æ–Ω</button>
          <button onclick="igor.drinkAlcohol('—è–≥—É–∞—Ä')">üêÜ –Ø–≥—É–∞—Ä</button>
          <button onclick="igor.drinkAlcohol('–±–∞–ª—Ç–∏–∫–∞9')">9Ô∏è‚É£ –ë–∞–ª—Ç–∏–∫–∞ 9</button>
        </div>

        <div style="margin-top:15px;">
          <button onclick="igor.eatFastFood('–±—É—Ä–≥–µ—Ä')">üçî –ë—É—Ä–≥–µ—Ä</button>
          <button onclick="igor.eatFastFood('–ø–∏—Ü—Ü—É')">üçï –ü–∏—Ü—Ü–∞</button>
          <button onclick="igor.eatFastFood('—à–∞—É—Ä–º—É')">üåØ –®–∞—É—Ä–º–∞</button>
          <button onclick="igor.eatFastFood('—Å—ã—Ä–Ω–∏–∫–∏')">ü•û –°—ã—Ä–Ω–∏–∫–∏</button>
        </div>

        <div style="margin-top:15px;">
          <button onclick="igor.listenToTatu()">üéß –°–ª—É—à–∞—Ç—å –¢–ê–¢–£</button>
          <button onclick="igor.watchTV()">üì∫ –°–º–æ—Ç—Ä–µ—Ç—å MTV</button>
          <button onclick="igor.sleep()">üò¥ –ü–æ—Å–ø–∞—Ç—å</button>
          <button onclick="igor.doTurnik()">ü§∏ –¢—É—Ä–Ω–∏–∫</button>
        </div>

        <div class="output" id="output">
          <div class="title">–°–æ—Å—Ç–æ—è–Ω–∏–µ –ò–≥–æ—Ä—è:</div>
          <pre id="state">...</pre>
        </div>

        <div id="astral" class="astral"></div>
      </div>

      <div id="achievements-tab" class="tab-content">
        <div class="achievements">
          <h3 style="color: #ffab91; margin-bottom: 15px;">üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h3>
          <div id="achievementsList"></div>
        </div>
      </div>

      <div id="internet-tab" class="tab-content">
        <div style="padding: 20px;">
          <h3 style="color: #ffab91;">üåê –ò–Ω—Ç–µ—Ä–Ω–µ—Ç 2007</h3>
          <div style="margin-top: 20px;">
            <button onclick="igor.visitOdnoklassniki()">üë• –û–¥–Ω–æ–∫–ª–∞—Å—Å–Ω–∏–∫–∏.ru</button>
            <button onclick="igor.visitVkontakte()">üéµ –í–ö–æ–Ω—Ç–∞–∫—Ç–µ</button>
            <button onclick="igor.visitMailRu()">üìß Mail.Ru</button>
            <button onclick="igor.downloadMusic()">üíø –°–∫–∞—á–∞—Ç—å mp3</button>
          </div>
          <div style="margin-top: 15px;">
            <button onclick="igor.watchYouTube()">üìπ YouTube (–Ω–æ–≤—ã–π —Å–∞–π—Ç!)</button>
            <button onclick="igor.playLineage()">‚öîÔ∏è –ò–≥—Ä–∞—Ç—å –≤ Lineage 2</button>
          </div>
        </div>

        <div class="output" id="output-internet">
          <div class="title">–°–æ—Å—Ç–æ—è–Ω–∏–µ –ò–≥–æ—Ä—è:</div>
          <pre id="state-internet">...</pre>
        </div>
      </div>

      <div id="babushka-tab" class="tab-content">
        <div style="padding: 20px;">
          <h3 style="color: #ffab91;">üëµ –£ –±–∞–±—É—à–∫–∏ –≤ –¥–µ—Ä–µ–≤–Ω–µ</h3>

          <div style="margin-top: 20px;">
            <span style="display:block; margin-bottom: 10px; color: #b39ddb;">üçΩÔ∏è –î–æ–º–∞—à–Ω—è—è –µ–¥–∞ –æ—Ç –±–∞–±—É—à–∫–∏:</span>
            <button onclick="igor.eatHomemadeFood('–∫–∞—à—É')">ü•£ –ö–∞—à–∞</button>
            <button onclick="igor.eatHomemadeFood('–∫–æ—Ç–ª–µ—Ç–∫–∏')">üçñ –ö–æ—Ç–ª–µ—Ç–∫–∏</button>
            <button onclick="igor.eatHomemadeFood('–±—É—Ç–µ—Ä–±—Ä–æ–¥—ã')">ü•™ –ë—É—Ç–µ—Ä–±—Ä–æ–¥—ã</button>
            <button onclick="igor.eatHomemadeFood('–≥—Ä–µ–Ω–∫–∏')">üçû –ì—Ä–µ–Ω–∫–∏</button>
            <button onclick="igor.eatHomemadeFood('—Å—É–ø')">ü•ò –°—É–ø</button>
          </div>

          <div style="margin-top: 20px;">
            <span style="display:block; margin-bottom: 10px; color: #b39ddb;">üåª –û–≥–æ—Ä–æ–¥–Ω—ã–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏:</span>
            <button onclick="igor.catchSnail()">üêå –ü–æ–π–º–∞—Ç—å —É–ª–∏—Ç–∫—É</button>
            <button onclick="igor.cleanLeaves()">üçÇ –£–±—Ä–∞—Ç—å –ª–∏—Å—Ç–≤—É</button>
            <button onclick="igor.harvestCrop()">ü•ï –°–æ–±—Ä–∞—Ç—å —É—Ä–æ–∂–∞–π</button>
          </div>
        </div>

        <div class="output" id="output-babushka">
          <div class="title">–°–æ—Å—Ç–æ—è–Ω–∏–µ –ò–≥–æ—Ä—è:</div>
          <pre id="state-babushka">...</pre>
        </div>
      </div>
    </div>

    <div id="popupContainer"></div>

    <script>
      // –î–û–°–¢–ò–ñ–ï–ù–ò–Ø
      const ACHIEVEMENTS = {
        firstDrink: { id: 'firstDrink', title: 'üç∫ –ü–µ—Ä–≤–∞—è', desc: '–í—ã–ø–∏–ª –ø–µ—Ä–≤—ã–π —Ä–∞–∑', unlocked: false },
        drunkard: { id: 'drunkard', title: 'ü•¥ –ê–ª–∫–∞—à', desc: '–î–æ—Å—Ç–∏–≥ 10 —É—Ä–æ–≤–Ω—è –∞–ª–∫–æ–≥–æ–ª—è', unlocked: false },
        tatuFan: { id: 'tatuFan', title: 'üéß –§–∞–Ω–∞—Ç –¢–ê–¢–£', desc: '–ü–æ—Å–ª—É—à–∞–ª 10 —Ç—Ä–µ–∫–æ–≤ –¢–ê–¢–£', unlocked: false },
        astralTraveler: { id: 'astralTraveler', title: 'üåå –ê—Å—Ç—Ä–∞–ª—å–Ω—ã–π –ø—É—Ç–Ω–∏–∫', desc: '–ü–æ–ø–∞–ª –≤ –∞—Å—Ç—Ä–∞–ª', unlocked: false },
        foodie: { id: 'foodie', title: 'üçî –û–±–∂–æ—Ä–∞', desc: '–°—ä–µ–ª 15 –ø–æ—Ä—Ü–∏–π —Ñ–∞—Å—Ç—Ñ—É–¥–∞', unlocked: false },
        yaguar: { id: 'yaguar', title: 'üêÜ –Ø–≥—É–∞—Ä—á–∏–∫', desc: '–í—ã–ø–∏–ª –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –Ø–≥—É–∞—Ä', unlocked: false },
        baltika9: { id: 'baltika9', title: '9Ô∏è‚É£ –ë–∞–ª—Ç–∏–∫–∞-–≤–µ—Ä–Ω—ã–π', desc: '–í—ã–ø–∏–ª –∫—É–ª—å—Ç–æ–≤—É—é –ë–∞–ª—Ç–∏–∫—É 9', unlocked: false },
        nostalgic: { id: 'nostalgic', title: 'üìº –ù–æ—Å—Ç–∞–ª—å–≥–∏—Ä—É—é—â–∏–π', desc: '–î–æ—Å—Ç–∏–≥ 20 —É—Ä–æ–≤–Ω—è —Ç–æ—Å–∫–∏', unlocked: false },
        lineage: { id: 'lineage', title: '‚öîÔ∏è –õ–∏–Ω—è–∂-–∑–∞–¥—Ä–æ—Ç', desc: '–ü–æ–∏–≥—Ä–∞–ª –≤ Lineage 2', unlocked: false },
        vkontakte: { id: 'vkontakte', title: 'üéµ –í–ö–æ–Ω—Ç–∞–∫—Ç–µ-–±—Ä–æ', desc: '–ó–∞—à—ë–ª –í–ö–æ–Ω—Ç–∞–∫—Ç–µ', unlocked: false },
        mtv: { id: 'mtv', title: 'üì∫ MTV Generation', desc: '–ü–æ—Å–º–æ—Ç—Ä–µ–ª MTV', unlocked: false },
        sleepyhead: { id: 'sleepyhead', title: 'üò¥ –°–æ–Ω—è', desc: '–ü–æ—Å–ø–∞–ª 5 —Ä–∞–∑', unlocked: false },
        syrniki: { id: 'syrniki', title: 'ü•û –°—ã—Ä–Ω–∏–∫–æ–º–∞–Ω', desc: '–°—ä–µ–ª —Å—ã—Ä–Ω–∏–∫–∏', unlocked: false },
        youtube2007: { id: 'youtube2007', title: 'üìπ YouTube-–ø–µ—Ä–≤–æ–æ—Ç–∫—Ä—ã–≤–∞—Ç–µ–ª—å', desc: '–ó–∞—à—ë–ª –Ω–∞ YouTube –≤ 2007', unlocked: false },
        fourIsSix: { id: 'fourIsSix', title: '4Ô∏è‚É£ = 6Ô∏è‚É£ –ü—Ä–æ—Å–≤–µ—Ç–ª—ë–Ω–Ω—ã–π', desc: '–£–∑–Ω–∞–ª –ø—Ä–∞–≤–¥—É: 4 —ç—Ç–æ 6!', unlocked: false },
        babushkaLove: { id: 'babushkaLove', title: 'üëµ –ë–∞–±—É—à–∫–∏–Ω –ª—é–±–∏–º—á–∏–∫', desc: '–°—ä–µ–ª 10 –ø–æ—Ä—Ü–∏–π –¥–æ–º–∞—à–Ω–µ–π –µ–¥—ã', unlocked: false },
        snailHunter: { id: 'snailHunter', title: 'üêå –û—Ö–æ—Ç–Ω–∏–∫ –Ω–∞ —É–ª–∏—Ç–æ–∫', desc: '–ü–æ–π–º–∞–ª —É–ª–∏—Ç–∫—É –Ω–∞ –æ–≥–æ—Ä–æ–¥–µ', unlocked: false },
        turnikMaster: { id: 'turnikMaster', title: 'ü§∏ –¢—É—Ä–Ω–∏–∫–º–µ–Ω', desc: '–ü–æ–∫—Ä—É—Ç–∏–ª—Å—è –Ω–∞ —Ç—É—Ä–Ω–∏–∫–µ 10 —Ä–∞–∑', unlocked: false },
        harvest: { id: 'harvest', title: 'ü•ï –û–≥–æ—Ä–æ–¥–Ω–∏–∫', desc: '–°–æ–±—Ä–∞–ª —É—Ä–æ–∂–∞–π —É –±–∞–±—É—à–∫–∏', unlocked: false },
        allAchievements: { id: 'allAchievements', title: 'üëë –õ–µ–≥–µ–Ω–¥–∞ 2007', desc: '–û—Ç–∫—Ä—ã–ª –≤—Å–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è', unlocked: false }
      };

      class Shizofrenia {
        constructor() {
          if (new.target === Shizofrenia) {
            throw new Error("–ù–µ–ª—å–∑—è —Å–æ–∑–¥–∞—Ç—å —á–∏—Å—Ç—É—é –®–∏–∑–æ—Ñ—Ä–µ–Ω–∏—é ü§Ø");
          }
        }
      }

      class Igor extends Shizofrenia {
        constructor() {
          super();
          this.alcoholLevel = 0;
          this.fastFoodConsumed = [];
          this.playlist = [];
          this.nostalgiaLevel = 0;
          this.inAstral = false;
          this.achievements = { ...ACHIEVEMENTS };
          this.stats = {
            drinksCount: 0,
            foodCount: 0,
            tatuPlays: 0,
            sleepCount: 0,
            internetVisits: 0,
            homemadeFoodCount: 0,
            turnikCount: 0,
            snailsCaught: 0
          };
          this.gameTime = 0; // –≤ —á–∞—Å–∞—Ö (–∏–≥—Ä–æ–≤–æ–µ –≤—Ä–µ–º—è)
          this.loadProgress();
          this.startTimeSystem();
          this.startRandomEvents();
        }

        startTimeSystem() {
          setInterval(() => {
            this.gameTime += 1; // 1 –∏–≥—Ä–æ–≤–æ–π —á–∞—Å –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
            const hours = this.gameTime % 24;
            const days = Math.floor(this.gameTime / 24);
            document.getElementById('timeDisplay').textContent =
              `üïê ${hours.toString().padStart(2, '0')}:00 (–î–µ–Ω—å ${days + 1})`;

            // –°–ª—É—á–∞–π–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã –≤—Ä–µ–º–µ–Ω–∏ —Å—É—Ç–æ–∫
            if (hours === 3 && Math.random() < 0.3) {
              this.triggerEvent('night', 'üåô –ì–ª—É–±–æ–∫–∞—è –Ω–æ—á—å... –ò–≥–æ—Ä—å —á—É–≤—Å—Ç–≤—É–µ—Ç —ç–∫–∑–∏—Å—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—É—é —Ç–æ—Å–∫—É.', [
                { text: '–í—ã–ø–∏—Ç—å –¥–ª—è —Ö—Ä–∞–±—Ä–æ—Å—Ç–∏', action: () => igor.drinkAlcohol('–≤–æ–¥–∫–∞') },
                { text: '–°–ª—É—à–∞—Ç—å –¢–ê–¢–£', action: () => igor.listenToTatu() }
              ]);
            }
          }, 10000); // –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
        }

        startRandomEvents() {
          setInterval(() => {
            if (Math.random() < 0.2 && !this.inAstral) {
              this.randomEvent();
            }
          }, 30000); // –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥ —à–∞–Ω—Å —Å–æ–±—ã—Ç–∏—è
        }

        randomEvent() {
          const events = [
            {
              title: 'üì± SMS –æ—Ç –û–ª–µ–≥–∞',
              text: '–û–ª–µ–≥: "–ì–¥–µ —Ç—ã? –ò–¥—ë–º –±—É—Ö–∞—Ç—å!"',
              buttons: [
                { text: '–ü–æ–π—Ç–∏', action: () => { igor.drinkAlcohol('–ø–∏–≤–æ'); igor.drinkAlcohol('–ø–∏–≤–æ'); } },
                { text: '–û—Ç–∫–∞–∑–∞—Ç—å—Å—è', action: () => { igor.nostalgiaLevel += 1; } }
              ]
            },
            {
              title: 'üíΩ –ü–æ —Ç–µ–ª–µ–∫—É "–ü–æ–∫–æ–ª–µ–Ω–∏–µ –Æ"',
              text: '–¢–∞–º –¥–µ–≤—á–æ–Ω–∫–∏ —Ç–∞–Ω—Ü—É—é—Ç –ø–æ–¥ –¢–ê–¢–£...',
              buttons: [
                { text: '–°–º–æ—Ç—Ä–µ—Ç—å', action: () => { igor.nostalgiaLevel += 3; igor.watchTV(); } },
                { text: '–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å', action: () => { } }
              ]
            },
            {
              title: 'üè™ –õ–∞—Ä—ë–∫ –Ω–∞ —É–≥–ª—É',
              text: '–ü—Ä–æ–¥–∞–≤—â–∏—Ü–∞: "–ü–∏–≤–æ –±—É–¥–µ—à—å –±—Ä–∞—Ç—å?"',
              buttons: [
                { text: '–í–∑—è—Ç—å –ø–∏–≤–æ', action: () => igor.drinkAlcohol('–ø–∏–≤–æ') },
                { text: '–í–∑—è—Ç—å —Å—ã—Ä–Ω–∏–∫–∏', action: () => igor.eatFastFood('—Å—ã—Ä–Ω–∏–∫–∏') }
              ]
            },
            {
              title: 'üíæ ICQ: "Uh-oh!"',
              text: '–°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –Ω–µ–∑–Ω–∞–∫–æ–º—Ü–∞: "–ü—Ä–∏–≤–µ—Ç! –ö–∞–∫ –¥–µ–ª–∞?"',
              buttons: [
                { text: '–û—Ç–≤–µ—Ç–∏—Ç—å', action: () => { igor.nostalgiaLevel += 2; } },
                { text: '–ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å', action: () => { } }
              ]
            },
            {
              title: '‚òéÔ∏è –ó–≤–æ–Ω–æ–∫ –æ—Ç –±–∞–±—É—à–∫–∏',
              text: '–ë–∞–±—É—à–∫–∞: "–í–Ω—É—á–µ–∫, –ø—Ä–∏–µ–∑–∂–∞–π! –Ø –±–æ—Ä—â–∞ –Ω–∞–≤–∞—Ä–∏–ª–∞, –∫–æ—Ç–ª–µ—Ç–æ–∫ –Ω–∞–∂–∞—Ä–∏–ª–∞!"',
              buttons: [
                { text: '–ü–æ–µ—Ö–∞—Ç—å', action: () => { switchTab('babushka'); igor.nostalgiaLevel += 3; } },
                { text: '–ü–æ—Ç–æ–º', action: () => { igor.nostalgiaLevel += 1; } }
              ]
            },
            {
              title: 'ü§∏ –ü–∞—Ü–∞–Ω—ã –∑–æ–≤—É—Ç –Ω–∞ —Ç—É—Ä–Ω–∏–∫',
              text: '–í–æ –¥–≤–æ—Ä–µ —Å–æ–±—Ä–∞–ª–∏—Å—å –ø–∞—Ü–∞–Ω—ã. –ó–æ–≤—É—Ç –ø–æ–∫–∞—á–∞—Ç—å—Å—è –Ω–∞ —Ç—É—Ä–Ω–∏–∫–µ.',
              buttons: [
                { text: '–ü–æ–π—Ç–∏', action: () => igor.doTurnik() },
                { text: '–û—Ç–∫–∞–∑–∞—Ç—å—Å—è', action: () => { } }
              ]
            },
            {
              title: 'üëµ –í–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ –±–∞–±—É—à–∫–µ',
              text: '–ò–≥–æ—Ä—å –≤—Å–ø–æ–º–Ω–∏–ª –ª–µ—Ç–æ —É –±–∞–±—É—à–∫–∏ –≤ –¥–µ—Ä–µ–≤–Ω–µ... –•–æ—Ä–æ—à–æ –±—ã–ª–æ...',
              buttons: [
                { text: '–ü–æ–∑–≤–æ–Ω–∏—Ç—å –±–∞–±—É—à–∫–µ', action: () => { igor.nostalgiaLevel += 2; } },
                { text: '–í—ã–ø–∏—Ç—å –æ—Ç —Ç–æ—Å–∫–∏', action: () => igor.drinkAlcohol('–≤–æ–¥–∫–∞') }
              ]
            }
          ];

          const event = events[Math.floor(Math.random() * events.length)];
          this.triggerEvent('random', event.text, event.buttons, event.title);
        }

        triggerEvent(type, message, buttons, title = '‚ö° –°–æ–±—ã—Ç–∏–µ') {
          const popup = document.createElement('div');
          popup.className = 'event-popup';
          popup.innerHTML = `
            <h3 style="margin: 0 0 10px 0; color: #f06292;">${title}</h3>
            <div>${message}</div>
            <div class="event-buttons">
              ${buttons.map((btn, i) => `<button onclick="handleEventBtn(${i})">${btn.text}</button>`).join('')}
            </div>
          `;

          window.currentEventButtons = buttons;
          document.getElementById('popupContainer').innerHTML = '';
          document.getElementById('popupContainer').appendChild(popup);

          setTimeout(() => popup.remove(), 8000);
        }

        drinkAlcohol(type = "–ø–∏–≤–æ") {
          const strengthMap = {
            "–ø–∏–≤–æ": 1,
            "–≤–∏–Ω–æ": 2,
            "–≤–æ–¥–∫–∞": 3,
            "—Å–∞–º–æ–≥–æ–Ω": 4,
            "—è–≥—É–∞—Ä": 5,
            "–±–∞–ª—Ç–∏–∫–∞9": 2
          };

          const strength = strengthMap[type.toLowerCase()] || 1;
          this.alcoholLevel += strength;
          this.stats.drinksCount++;

          // –ü–∞—Å—Ö–∞–ª–∫–∞ "4 —ç—Ç–æ 6"
          if (this.alcoholLevel === 4) {
            this.alcoholLevel = 6;
            this.unlockAchievement('fourIsSix');
            this.showSpecialPopup('4Ô∏è‚É£ = 6Ô∏è‚É£', '–ò–≥–æ—Ä—å –æ—Å–æ–∑–Ω–∞–ª –ø—Ä–∞–≤–¥—É: 4 —ç—Ç–æ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ 6! –ê–ª–∫–æ–≥–æ–ª—å +2 –±–æ–Ω—É—Å!');
          }

          if (this.stats.drinksCount === 1) this.unlockAchievement('firstDrink');
          if (this.alcoholLevel >= 10) this.unlockAchievement('drunkard');
          if (type === '—è–≥—É–∞—Ä') this.unlockAchievement('yaguar');
          if (type === '–±–∞–ª—Ç–∏–∫–∞9') this.unlockAchievement('baltika9');

          const reactions = {
            "—è–≥—É–∞—Ä": "üêÜ –≠—Ç–æ –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –Ω–∞–ø–∏—Ç–æ–∫! –ò–≥–æ—Ä—å —á—É–≤—Å—Ç–≤—É–µ—Ç –ø—Ä–∏–ª–∏–≤ —Å–∏–ª 2007 –≥–æ–¥–∞!",
            "–±–∞–ª—Ç–∏–∫–∞9": "9Ô∏è‚É£ –ö—Ä–µ–ø–∫–∞—è! –ù–∞—Å—Ç–æ—è—â–∏–π –≤–∫—É—Å –¥–≤–æ—Ä–æ–≤ –∏ –ø–æ–¥—ä–µ–∑–¥–æ–≤...",
            "—Å–∞–º–æ–≥–æ–Ω": "üî• –û–±–∂–∏–≥–∞–µ—Ç! –ò–≥–æ—Ä—å –≤–∏–¥–∏—Ç –ø—Ä–µ–¥–∫–æ–≤ –≤ –∞—Å—Ç—Ä–∞–ª–µ!"
          };

          this.checkAstral();
          this.renderState(reactions[type] || `üçª –ò–≥–æ—Ä—å –≤—ã–ø–∏–ª ${type}. +${strength} –∫ –∞–ª–∫–æ–≥–æ–ª—é.`);
          this.saveProgress();
        }

        eatFastFood(item) {
          this.fastFoodConsumed.push(item);
          this.stats.foodCount++;

          if (this.alcoholLevel > 0) this.alcoholLevel = Math.max(0, this.alcoholLevel - 1);
          if (this.stats.foodCount >= 15) this.unlockAchievement('foodie');
          if (item === '—Å—ã—Ä–Ω–∏–∫–∏') this.unlockAchievement('syrniki');

          this.checkExitAstral();
          this.renderState(`üçΩÔ∏è –ò–≥–æ—Ä—å —Å—ä–µ–ª ${item}. –ê–ª–∫–æ–≥–æ–ª—å –Ω–µ–º–Ω–æ–≥–æ —Å–Ω–∏–∑–∏–ª—Å—è.`);
          this.saveProgress();
        }

        listenToTatu(track = this.randomTrack()) {
          this.playlist.push(track);
          this.nostalgiaLevel += 2;
          this.stats.tatuPlays++;

          // –ü–∞—Å—Ö–∞–ª–∫–∞ "4 —ç—Ç–æ 6" –¥–ª—è —Ç–æ—Å–∫–∏
          if (this.nostalgiaLevel === 4) {
            this.nostalgiaLevel = 6;
            this.unlockAchievement('fourIsSix');
            this.showSpecialPopup('4Ô∏è‚É£ = 6Ô∏è‚É£', '–ò–≥–æ—Ä—å –ø–æ–Ω—è–ª: 4 —É—Ä–æ–≤–Ω—è —Ç–æ—Å–∫–∏ = 6 —É—Ä–æ–≤–Ω–µ–π! –ú–µ–º—ã –Ω–µ –≤—Ä—É—Ç!');
          }

          if (this.stats.tatuPlays >= 10) this.unlockAchievement('tatuFan');
          if (this.nostalgiaLevel >= 20) this.unlockAchievement('nostalgic');

          this.checkAstral();
          this.renderState(`üé∂ –ò–≥–æ—Ä—å —Å–ª—É—à–∞–µ—Ç –¢–ê–¢–£: "${track}" (+2 —Ç–æ—Å–∫–∏ –ø–æ 2007)`);
          this.saveProgress();
        }

        watchTV() {
          this.nostalgiaLevel += 3;
          this.unlockAchievement('mtv');
          const shows = [
            '–ü—Ä–æ–∏–≥—Ä—ã–≤–∞—Ç–µ–ª—å MTV —Å –¢–∏–º—É—Ä–æ–º –†–æ–¥—Ä–∏–≥–µ–∑–æ–º',
            'TRL —Å –¢–ê–¢–£ –Ω–∞ –ø–µ—Ä–≤–æ–º –º–µ—Å—Ç–µ',
            '–ë–∏–≤–∏—Å –∏ –ë–∞—Ç—Ç—Ö–µ–¥',
            '–ö–ª–∏–ø –¢–ê–¢–£ "–ù–∞—Å –Ω–µ –¥–æ–≥–æ–Ω—è—Ç"'
          ];
          const show = shows[Math.floor(Math.random() * shows.length)];
          this.renderState(`üì∫ –ò–≥–æ—Ä—å —Å–º–æ—Ç—Ä–∏—Ç "${show}". –ù–æ—Å—Ç–∞–ª—å–≥–∏—è –∑–∞—à–∫–∞–ª–∏–≤–∞–µ—Ç! (+3 —Ç–æ—Å–∫–∏)`);
          this.saveProgress();
        }

        sleep() {
          this.alcoholLevel = Math.max(0, this.alcoholLevel - 3);
          this.gameTime += 8;
          this.stats.sleepCount++;

          if (this.stats.sleepCount >= 5) this.unlockAchievement('sleepyhead');

          this.checkExitAstral();
          this.renderState(`üò¥ –ò–≥–æ—Ä—å –ø–æ—Å–ø–∞–ª 8 —á–∞—Å–æ–≤. –ü—Ä–æ—Å–Ω—É–ª—Å—è —Å –ø–æ—Ö–º–µ–ª—å—è, –Ω–æ –∞–ª–∫–æ–≥–æ–ª—å —Å–Ω–∏–∑–∏–ª—Å—è.`);
          this.saveProgress();
        }

        visitOdnoklassniki() {
          this.nostalgiaLevel += 4;
          this.stats.internetVisits++;
          this.renderState(`üë• –ò–≥–æ—Ä—å –∑–∞—à—ë–ª –≤ –û–¥–Ω–æ–∫–ª–∞—Å—Å–Ω–∏–∫–∏. –ü–æ—Å—Ç–∞–≤–∏–ª –≤—Å–µ–º "–∫–ª–∞—Å—Å"! (+4 —Ç–æ—Å–∫–∏)`);
          this.saveProgress();
        }

        visitVkontakte() {
          this.nostalgiaLevel += 5;
          this.stats.internetVisits++;
          this.unlockAchievement('vkontakte');
          this.renderState(`üéµ –ò–≥–æ—Ä—å –∑–∞—à—ë–ª –í–ö–æ–Ω—Ç–∞–∫—Ç–µ. –°–∫–∞—á–∏–≤–∞–µ—Ç mp3 –¢–ê–¢–£... (+5 —Ç–æ—Å–∫–∏)`);
          this.saveProgress();
        }

        visitMailRu() {
          this.nostalgiaLevel += 2;
          this.stats.internetVisits++;
          this.renderState(`üìß –ò–≥–æ—Ä—å –ø—Ä–æ–≤–µ—Ä–∏–ª –ø–æ—á—Ç—É –Ω–∞ Mail.Ru. –¢–æ–ª—å–∫–æ —Å–ø–∞–º –æ—Ç –û–¥–Ω–æ–∫–ª–∞—Å—Å–Ω–∏–∫–æ–≤. (+2 —Ç–æ—Å–∫–∏)`);
          this.saveProgress();
        }

        downloadMusic() {
          this.nostalgiaLevel += 3;
          const sites = ['Kroogi.ru', 'Zaycev.net', 'MP3.cc', 'Torrents.ru'];
          const site = sites[Math.floor(Math.random() * sites.length)];
          this.renderState(`üíø –ò–≥–æ—Ä—å –∫–∞—á–∞–µ—Ç –º—É–∑—ã–∫—É —Å ${site}. –û—Å—Ç–∞–ª–æ—Å—å 2 —á–∞—Å–∞... (+3 —Ç–æ—Å–∫–∏)`);
          this.saveProgress();
        }

        watchYouTube() {
          this.nostalgiaLevel += 3;
          this.unlockAchievement('youtube2007');
          this.renderState(`üìπ –ò–≥–æ—Ä—å —Å–º–æ—Ç—Ä–∏—Ç YouTube. –¢–∞–º —Å–º–µ—à–Ω—ã–µ –≤–∏–¥–æ—Å—ã –≤ 240p! (+3 —Ç–æ—Å–∫–∏)`);
          this.saveProgress();
        }

        playLineage() {
          this.nostalgiaLevel += 5;
          this.unlockAchievement('lineage');
          this.alcoholLevel += 1;
          this.renderState(`‚öîÔ∏è –ò–≥–æ—Ä—å –∏–≥—Ä–∞–µ—Ç –≤ Lineage 2. –£–±–∏–ª –æ—Ä–∫–∞, –≤—ã–ø–∏–ª –∑–∞ –ø–æ–±–µ–¥—É! (+5 —Ç–æ—Å–∫–∏, +1 –∞–ª–∫–æ–≥–æ–ª—å)`);
          this.saveProgress();
        }

        // –ù–û–í–´–ï –ú–ï–¢–û–î–´ - –ë–ê–ë–£–®–ö–ê
        eatHomemadeFood(item) {
          this.stats.homemadeFoodCount = (this.stats.homemadeFoodCount || 0) + 1;
          this.alcoholLevel = Math.max(0, this.alcoholLevel - 3);
          this.nostalgiaLevel += 1;

          if (this.stats.homemadeFoodCount >= 10) this.unlockAchievement('babushkaLove');

          const reactions = {
            "–∫–∞—à—É": "ü•£ –ë–∞–±—É—à–∫–∞ –Ω–∞–≤–∞—Ä–∏–ª–∞ –∫–∞—à—É —Å –º–æ–ª–æ–∫–æ–º. –ö–∞–∫ –≤ –¥–µ—Ç—Å—Ç–≤–µ!",
            "–∫–æ—Ç–ª–µ—Ç–∫–∏": "üçñ –î–æ–º–∞—à–Ω–∏–µ –∫–æ—Ç–ª–µ—Ç–∫–∏ —Ç–∞—é—Ç –≤–æ —Ä—Ç—É. –í–∫—É—Å–Ω–µ–µ —á–µ–º –≤ –ª—é–±–æ–º —Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ!",
            "–±—É—Ç–µ—Ä–±—Ä–æ–¥—ã": "ü•™ –ë–∞–±—É—à–∫–∞ –Ω–∞–º–∞–∑–∞–ª–∞ –º–∞—Å–ª–æ —Ç–æ–ª—Å—Ç—ã–º —Å–ª–æ–µ–º, –∫–∞–∫ –Ω–∞–¥–æ!",
            "–≥—Ä–µ–Ω–∫–∏": "üçû –•—Ä—É—Å—Ç—è—â–∏–µ –≥—Ä–µ–Ω–∫–∏ —Å —á–µ—Å–Ω–æ–∫–æ–º. –ó–∞–ø–∞—Ö –Ω–∞ –≤—Å—é –¥–µ—Ä–µ–≤–Ω—é!",
            "—Å—É–ø": "ü•ò –ù–∞–≤–∞—Ä–∏—Å—Ç—ã–π —Å—É–ø –Ω–∞ –∫—É—Ä–∏–Ω–æ–º –±—É–ª—å–æ–Ω–µ. –î—É—à–∞ —Ä–∞–¥—É–µ—Ç—Å—è!"
          };

          this.checkExitAstral();
          this.renderState(reactions[item] || `üëµ –ë–∞–±—É—à–∫–∞ –Ω–∞–∫–æ—Ä–º–∏–ª–∞ ${item}. (-3 –∞–ª–∫–æ–≥–æ–ª—å, +1 —Ç–æ—Å–∫–∞)`);
          this.saveProgress();
        }

        catchSnail() {
          this.stats.snailsCaught = (this.stats.snailsCaught || 0) + 1;
          this.unlockAchievement('snailHunter');

          const outcomes = [
            "üêå –ò–≥–æ—Ä—å –ø–æ–π–º–∞–ª –±–æ–ª—å—à—É—é —É–ª–∏—Ç–∫—É! –û–Ω–∞ –º–µ–¥–ª–µ–Ω–Ω–æ –ø–æ–ª–∑—ë—Ç –ø–æ —Ä—É–∫–µ...",
            "üêå –£–ª–∏—Ç–∫–∞ —Å–ø—Ä—è—Ç–∞–ª–∞—Å—å –≤ —Ä–∞–∫–æ–≤–∏–Ω—É. –ò–≥–æ—Ä—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ –ø–æ–ª–æ–∂–∏–ª –µ—ë –æ–±—Ä–∞—Ç–Ω–æ.",
            "üêå –ò–≥–æ—Ä—å –Ω–∞—à—ë–ª —Ü–µ–ª—ã—Ö —Ç—Ä–∏ —É–ª–∏—Ç–∫–∏! –£—Å—Ç—Ä–æ–∏–ª –∏–º –≥–æ–Ω–∫–∏ –Ω–∞ –≥—Ä—è–¥–∫–µ.",
            "üêå –£–ª–∏—Ç–∫–∞ –æ—Å—Ç–∞–≤–∏–ª–∞ –±–ª–µ—Å—Ç—è—â–∏–π —Å–ª–µ–¥. –ò–≥–æ—Ä—å –∑–∞–¥—É–º–∞–ª—Å—è –æ –±—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –±—ã—Ç–∏—è.",
            "üêåüí≠ –ò–≥–æ—Ä—å –¥–æ–ª–≥–æ —Å–º–æ—Ç—Ä–µ–ª –Ω–∞ —É–ª–∏—Ç–∫—É –∏ –ø–æ–Ω—è–ª: –æ–Ω —Ç–æ–∂–µ –º–µ–¥–ª–µ–Ω–Ω–æ –ø–æ–ª–∑—ë—Ç –ø–æ –∂–∏–∑–Ω–∏..."
          ];

          const outcome = outcomes[Math.floor(Math.random() * outcomes.length)];
          this.nostalgiaLevel += 2;
          this.renderState(`${outcome} (+2 —Ç–æ—Å–∫–∞)`);
          this.saveProgress();
        }

        cleanLeaves() {
          this.alcoholLevel = Math.max(0, this.alcoholLevel - 2);

          const outcomes = [
            "üçÇ –ò–≥–æ—Ä—å —É–±—Ä–∞–ª –ª–∏—Å—Ç–≤—É –≥—Ä–∞–±–ª—è–º–∏. –§–∏–∑–∏—á–µ—Å–∫–∏–π —Ç—Ä—É–¥ –æ—Ç—Ä–µ–∑–≤–ª—è–µ—Ç!",
            "üçÇ –ö—É—á–∞ –ª–∏—Å—Ç—å–µ–≤ —Ç–∞–∫–∞—è –±–æ–ª—å—à–∞—è! –ò–≥–æ—Ä—å –ø—Ä—ã–≥–Ω—É–ª –≤ –Ω–µ—ë, –∫–∞–∫ –≤ –¥–µ—Ç—Å—Ç–≤–µ.",
            "üçÇ –ë–∞–±—É—à–∫–∞ –¥–æ–≤–æ–ª—å–Ω–∞: –æ–≥–æ—Ä–æ–¥ —á–∏—Å—Ç—ã–π. –ò–≥–æ—Ä—å –ø–æ–ª—É—á–∏–ª –ø–∏—Ä–æ–∂–æ–∫ –≤ –Ω–∞–≥—Ä–∞–¥—É!",
            "üçÇ –ò–≥–æ—Ä—å —É–±–∏—Ä–∞–µ—Ç –ª–∏—Å—Ç–≤—É –∏ –¥—É–º–∞–µ—Ç –æ —Ç–æ–º, –∫–∞–∫ –ª–∏—Å—Ç—å—è –ø–∞–¥–∞—é—Ç, –∫–∞–∫ –ø—Ä–æ—Ö–æ–¥–∏—Ç –∂–∏–∑–Ω—å..."
          ];

          const outcome = outcomes[Math.floor(Math.random() * outcomes.length)];
          this.nostalgiaLevel += 1;

          this.checkExitAstral();
          this.renderState(`${outcome} (-2 –∞–ª–∫–æ–≥–æ–ª—å, +1 —Ç–æ—Å–∫–∞)`);
          this.saveProgress();
        }

        harvestCrop() {
          this.unlockAchievement('harvest');
          this.nostalgiaLevel += 3;

          const crops = [
            "ü•ï –ò–≥–æ—Ä—å –Ω–∞–∫–æ–ø–∞–ª –∫–∞—Ä—Ç–æ—à–∫–∏. –ë–∞–±—É—à–∫–∞ –≤–∞—Ä–∏—Ç –µ—ë –≤ –º—É–Ω–¥–∏—Ä–µ!",
            "ü•í –û–≥—É—Ä—Ü—ã –ø—Ä—è–º–æ —Å –≥—Ä—è–¥–∫–∏ - —Ö—Ä—É—Å—Ç—è—â–∏–µ –∏ –ø–∞—Ö–Ω—É—Ç –ª–µ—Ç–æ–º!",
            "üçÖ –ü–æ–º–∏–¥–æ—Ä—ã —Ç–∞–∫–∏–µ –∫—Ä–∞—Å–Ω—ã–µ –∏ —Å–æ—á–Ω—ã–µ! –í –≥–æ—Ä–æ–¥–µ —Ç–∞–∫–∏—Ö –Ω–µ –∫—É–ø–∏—à—å.",
            "üßÖ –ò–≥–æ—Ä—å —Å–æ–±—Ä–∞–ª –ª—É–∫. –ì–ª–∞–∑–∞ —Å–ª–µ–∑—è—Ç—Å—è, –Ω–æ —ç—Ç–æ –ø—Ä–∏—è—Ç–Ω—ã–µ —Å–ª—ë–∑—ã –Ω–æ—Å—Ç–∞–ª—å–≥–∏–∏.",
            "üåª –ò–≥–æ—Ä—å –Ω–∞—Ä–≤–∞–ª –ø–æ–¥—Å–æ–ª–Ω—É—Ö–æ–≤. –ë–∞–±—É—à–∫–∞ –±—É–¥–µ—Ç —Å—É—à–∏—Ç—å —Å–µ–º–µ—á–∫–∏!"
          ];

          const crop = crops[Math.floor(Math.random() * crops.length)];
          this.renderState(`${crop} (+3 —Ç–æ—Å–∫–∞ –ø–æ –¥–µ—Ä–µ–≤–µ–Ω—Å–∫–æ–π –∂–∏–∑–Ω–∏)`);
          this.saveProgress();
        }

        // –¢–£–†–ù–ò–ö
        doTurnik() {
          this.stats.turnikCount = (this.stats.turnikCount || 0) + 1;
          this.alcoholLevel = Math.max(0, this.alcoholLevel - 1);

          if (this.stats.turnikCount >= 10) this.unlockAchievement('turnikMaster');

          const outcomes = [
            "ü§∏ –ò–≥–æ—Ä—å –ø–æ–¥—Ç—è–Ω—É–ª—Å—è 5 —Ä–∞–∑. –ù–µ–ø–ª–æ—Ö–æ –¥–ª—è –∞–ª–∫–∞—à–∞!",
            "ü§∏ –ü–æ–∫—Ä—É—Ç–∏–ª—Å—è –Ω–∞ —Ç—É—Ä–Ω–∏–∫–µ. –ì–æ–ª–æ–≤–∞ –∑–∞–∫—Ä—É–∂–∏–ª–∞—Å—å, –Ω–æ —ç—Ç–æ –±—ã–ª–æ –≤–µ—Å–µ–ª–æ!",
            "ü§∏ –ò–≥–æ—Ä—å –≤–∏—Å–∏—Ç –Ω–∞ —Ç—É—Ä–Ω–∏–∫–µ –∏ —Å–º–æ—Ç—Ä–∏—Ç –Ω–∞ –Ω–µ–±–æ. –§–∏–ª–æ—Å–æ—Ñ—Å—Ç–≤—É–µ—Ç.",
            "ü§∏üí´ –ü–æ–ø—ã—Ç–∞–ª—Å—è —Å–¥–µ–ª–∞—Ç—å —Å–æ–ª–Ω—ã—à–∫–æ, –Ω–æ —É–ø–∞–ª. –ó–∞—Ç–æ –æ—Ç—Ä–µ–∑–≤–µ–ª!",
            "ü§∏ –¢—É—Ä–Ω–∏–∫ —Å–∫—Ä–∏–ø–∏—Ç –ø–æ–¥ –≤–µ—Å–æ–º –ò–≥–æ—Ä—è. –ù–∞–¥–æ –º–µ–Ω—å—à–µ –ø–∏—Ç—å –∏ –±–æ–ª—å—à–µ –∫–∞—á–∞—Ç—å—Å—è!",
            "ü§∏ –ò–≥–æ—Ä—å –¥–µ–ª–∞–µ—Ç –≤—ã—Ö–æ–¥ —Å–∏–ª–æ–π! –ü–∞—Ü–∞–Ω—ã —Å —Ä–∞–π–æ–Ω–∞ —É–≤–∞–∂–∏—Ç–µ–ª—å–Ω–æ –∫–∏–≤–∞—é—Ç."
          ];

          const outcome = outcomes[Math.floor(Math.random() * outcomes.length)];

          this.checkExitAstral();
          this.renderState(`${outcome} (-1 –∞–ª–∫–æ–≥–æ–ª—å)`);
          this.saveProgress();
        }

        // –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π popup –¥–ª—è –≤–∞–∂–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
        showSpecialPopup(title, message) {
          const popup = document.createElement('div');
          popup.className = 'event-popup';
          popup.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
          popup.innerHTML = `
            <h3 style="margin: 0 0 10px 0; color: #fff; font-size: 24px;">${title}</h3>
            <div style="color: #fff; font-size: 16px;">${message}</div>
          `;
          document.getElementById('popupContainer').appendChild(popup);
          setTimeout(() => popup.remove(), 5000);
        }

        randomTrack() {
          const tracks = [
            "–ù–∞—Å –Ω–µ –¥–æ–≥–æ–Ω—è—Ç",
            "–Ø —Å–æ—à–ª–∞ —Å —É–º–∞",
            "30 –º–∏–Ω—É—Ç",
            "–õ—é–¥–∏-–∏–Ω–≤–∞–ª–∏–¥—ã",
            "–ü—Ä–æ—Å—Ç—ã–µ –¥–≤–∏–∂–µ–Ω–∏—è",
            "–ö–ª–æ—É–Ω—ã",
            "–û–±–µ–∑—å—è–Ω–∫–∞ –Ω–æ–ª—å",
            "–ë–µ–ª—ã–π –ø–ª–∞—â–∏–∫",
            "–ó–∞—á–µ–º —è",
            "–í—Å—ë, —á—Ç–æ —è —Ö–æ—á—É"
          ];
          return tracks[Math.floor(Math.random() * tracks.length)];
        }

        checkAstral() {
          const box = document.getElementById("igorBox");
          const astralDiv = document.getElementById("astral");

          if (!this.inAstral && this.alcoholLevel >= 7 && this.nostalgiaLevel >= 6) {
            this.inAstral = true;
            this.unlockAchievement('astralTraveler');
            box.classList.add("astral-mode");
            astralDiv.classList.add("astral-text");
            astralDiv.textContent = "üåå –ò–≥–æ—Ä—å –≤—ã–ø–∞–ª –≤ –∞—Å—Ç—Ä–∞–ª... –û–Ω –≤–∏–¥–∏—Ç –õ–µ–Ω—É –∏ –Æ–ª—é –∏–∑ –¢–ê–¢–£ –≤ –∫–æ—Å–º–æ—Å–µ...";
          }
        }

        checkExitAstral() {
          const box = document.getElementById("igorBox");
          const astralDiv = document.getElementById("astral");

          // –í—ã—Ö–æ–¥ –∏–∑ –∞—Å—Ç—Ä–∞–ª–∞ –ø—Ä–∏ –Ω–∏–∑–∫–æ–º —É—Ä–æ–≤–Ω–µ –∞–ª–∫–æ–≥–æ–ª—è –∏–ª–∏ —Ç–æ—Å–∫–∏
          if (this.inAstral && (this.alcoholLevel < 5 || this.nostalgiaLevel < 4)) {
            this.inAstral = false;
            box.classList.remove("astral-mode");
            astralDiv.classList.remove("astral-text");
            astralDiv.textContent = "";
            this.showSpecialPopup('üåç –í–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ', '–ò–≥–æ—Ä—å –≤–µ—Ä–Ω—É–ª—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å. –ê—Å—Ç—Ä–∞–ª –æ—Ç–ø—É—Å—Ç–∏–ª –µ–≥–æ...');
          }
        }

        unlockAchievement(id) {
          if (this.achievements[id] && !this.achievements[id].unlocked) {
            this.achievements[id].unlocked = true;
            this.showAchievementPopup(this.achievements[id]);
            this.renderAchievements();
            this.saveProgress();

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –≤—Å–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
            const all = Object.values(this.achievements).filter(a => a.id !== 'allAchievements');
            if (all.every(a => a.unlocked) && !this.achievements.allAchievements.unlocked) {
              setTimeout(() => this.unlockAchievement('allAchievements'), 1000);
            }
          }
        }

        showAchievementPopup(achievement) {
          const popup = document.createElement('div');
          popup.className = 'achievement-popup';
          popup.innerHTML = `
            <div style="font-size: 18px; font-weight: bold;">üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ!</div>
            <div style="margin-top: 10px;">${achievement.title}</div>
            <div style="font-size: 12px; margin-top: 5px; opacity: 0.9;">${achievement.desc}</div>
          `;
          document.getElementById('popupContainer').appendChild(popup);
          setTimeout(() => popup.remove(), 4000);
        }

        renderAchievements() {
          const container = document.getElementById('achievementsList');
          container.innerHTML = Object.values(this.achievements)
            .map(a => `
              <div class="achievement-item ${a.unlocked ? 'unlocked' : ''}">
                ${a.title}<br>
                <small style="opacity: 0.7;">${a.desc}</small>
                ${a.unlocked ? ' ‚úì' : ' üîí'}
              </div>
            `).join('');
        }

        saveProgress() {
          const data = {
            alcoholLevel: this.alcoholLevel,
            fastFoodConsumed: this.fastFoodConsumed,
            playlist: this.playlist,
            nostalgiaLevel: this.nostalgiaLevel,
            inAstral: this.inAstral,
            achievements: this.achievements,
            stats: this.stats,
            gameTime: this.gameTime
          };
          localStorage.setItem('igorSaveGame', JSON.stringify(data));
        }

        loadProgress() {
          const saved = localStorage.getItem('igorSaveGame');
          if (saved) {
            const data = JSON.parse(saved);
            this.alcoholLevel = data.alcoholLevel || 0;
            this.fastFoodConsumed = data.fastFoodConsumed || [];
            this.playlist = data.playlist || [];
            this.nostalgiaLevel = data.nostalgiaLevel || 0;
            this.inAstral = data.inAstral || false;
            this.gameTime = data.gameTime || 0;

            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Å –¥–µ—Ñ–æ–ª—Ç–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π
            if (data.stats) {
              this.stats = {
                drinksCount: data.stats.drinksCount || 0,
                foodCount: data.stats.foodCount || 0,
                tatuPlays: data.stats.tatuPlays || 0,
                sleepCount: data.stats.sleepCount || 0,
                internetVisits: data.stats.internetVisits || 0,
                homemadeFoodCount: data.stats.homemadeFoodCount || 0,
                turnikCount: data.stats.turnikCount || 0,
                snailsCaught: data.stats.snailsCaught || 0
              };
            }

            if (data.achievements) {
              Object.keys(data.achievements).forEach(key => {
                if (this.achievements[key]) {
                  this.achievements[key].unlocked = data.achievements[key].unlocked;
                }
              });
            }
          }
        }

        renderState(message) {
          let mood = "üôÇ";

          if (this.alcoholLevel >= 4 && this.alcoholLevel < 7) mood = "üòµ";
          else if (this.alcoholLevel >= 7) mood = "üíÄ";
          else if (this.nostalgiaLevel >= 15) mood = "üò¢";

          const state = `
${message}

üß† –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ: ${mood}
üç∑ –ê–ª–∫–æ–≥–æ–ª—å: ${this.alcoholLevel}
üìº –¢–æ—Å–∫–∞ –ø–æ 2007: ${this.nostalgiaLevel}
üçî –§–∞—Å—Ç—Ñ—É–¥: ${this.stats.foodCount || 0} | üëµ –î–æ–º–∞—à–Ω—è—è –µ–¥–∞: ${this.stats.homemadeFoodCount || 0}
üéß –¢–ê–¢–£: ${this.stats.tatuPlays || 0} | ü§∏ –¢—É—Ä–Ω–∏–∫: ${this.stats.turnikCount || 0} | üêå –£–ª–∏—Ç–∫–∏: ${this.stats.snailsCaught || 0}
üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏–π: ${Object.values(this.achievements).filter(a => a.unlocked).length}/${Object.keys(this.achievements).length}
        `;
          document.getElementById("state").textContent = state;

          // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤–æ –≤—Å–µ—Ö –≤–∫–ª–∞–¥–∫–∞—Ö
          const internetState = document.getElementById("state-internet");
          if (internetState) {
            internetState.textContent = state;
          }
          const babushkaState = document.getElementById("state-babushka");
          if (babushkaState) {
            babushkaState.textContent = state;
          }
        }
      }

      // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
      function switchTab(tabName) {
        document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

        event.target.classList.add('active');
        document.getElementById(`${tabName}-tab`).classList.add('active');

        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –≤–∫–ª–∞–¥–∫—É
        localStorage.setItem('igorActiveTab', tabName);
      }

      function handleEventBtn(index) {
        if (window.currentEventButtons && window.currentEventButtons[index]) {
          window.currentEventButtons[index].action();
          document.getElementById('popupContainer').innerHTML = '';
        }
      }

      function restoreActiveTab() {
        const savedTab = localStorage.getItem('igorActiveTab');
        if (savedTab && savedTab !== 'main') {
          // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å –≥–ª–∞–≤–Ω–æ–π –≤–∫–ª–∞–¥–∫–∏
          document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
          document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

          // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—É—é –≤–∫–ª–∞–¥–∫—É
          const tabButtons = document.querySelectorAll('.tab-button');
          const tabs = ['main', 'achievements', 'internet', 'babushka'];
          const tabIndex = tabs.indexOf(savedTab);
          if (tabIndex !== -1 && tabButtons[tabIndex]) {
            tabButtons[tabIndex].classList.add('active');
            document.getElementById(`${savedTab}-tab`).classList.add('active');
          }
        }
      }

      const igor = new Igor();
      igor.renderState("–ò–≥–æ—Ä—å —Ç–æ–ª—å–∫–æ –ø–æ—è–≤–∏–ª—Å—è –≤ —ç—Ç–æ–º –±—Ä–µ–Ω–Ω–æ–º –º–∏—Ä–µ. 2007 –≥–æ–¥. –í—Å—ë –≤–ø–µ—Ä–µ–¥–∏...");
      igor.renderAchievements();

      // –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Å–ª–æ–≤–∏—è –∞—Å—Ç—Ä–∞–ª–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
      igor.checkAstral();

      // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã –∞—Å—Ç—Ä–∞–ª–∞ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
      if (igor.inAstral) {
        const box = document.getElementById("igorBox");
        const astralDiv = document.getElementById("astral");
        box.classList.add("astral-mode");
        astralDiv.classList.add("astral-text");
        astralDiv.textContent = "üåå –ò–≥–æ—Ä—å –≤—ã–ø–∞–ª –≤ –∞—Å—Ç—Ä–∞–ª... –û–Ω –≤–∏–¥–∏—Ç –õ–µ–Ω—É –∏ –Æ–ª—é –∏–∑ –¢–ê–¢–£ –≤ –∫–æ—Å–º–æ—Å–µ...";
      }

      // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –≤–∫–ª–∞–¥–∫—É –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏
      restoreActiveTab();
    </script>
  </body>

</html>
